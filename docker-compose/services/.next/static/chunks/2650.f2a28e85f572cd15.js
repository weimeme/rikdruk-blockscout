(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2650],{84510:function(a,e,r){"use strict";r.r(e),r.d(e,{default:function(){return pages_MarketplaceApp}});var l=r(85893),t=r(12498),s=r(7754),n=r(23100),o=r(83757),c=r(1861),i=r(11163),u=r(67294),p=r(99640),d=r(44831),h=r(38117),b=r(89321),k=r(98393),w=r(97526),f=r(35202),m=r(38793);let y=d.Z.features.marketplace,Z=y.isEnabled?y.configUrl:"",MarketplaceAppContent=a=>{let{address:e,data:r,isPending:o}=a,{iframeRef:i,isReady:h}=(0,c.r)(),[b,k]=(0,u.useState)(0),[w,m]=(0,u.useState)(o),{colorMode:y}=(0,t.If)();(0,u.useEffect)(()=>{k(a=>a+1)},[e]);let Z=(0,u.useCallback)(()=>{m(!1)},[]);return(0,u.useEffect)(()=>{if(r&&!w){var a,e;let l={blockscoutColorMode:y,blockscoutRootUrl:d.Z.app.baseUrl+(0,p.B)({pathname:"/"}),blockscoutAddressExplorerUrl:d.Z.app.baseUrl+(0,p.B)({pathname:"/address/[hash]",query:{hash:""}}),blockscoutTransactionExplorerUrl:d.Z.app.baseUrl+(0,p.B)({pathname:"/tx/[hash]",query:{hash:""}}),blockscoutNetworkName:d.Z.chain.name,blockscoutNetworkId:Number(d.Z.chain.id),blockscoutNetworkCurrency:d.Z.chain.currency,blockscoutNetworkRpc:d.Z.chain.rpcUrl};null==i||null===(e=i.current)||void 0===e||null===(a=e.contentWindow)||void 0===a||a.postMessage(l,r.url)}},[w,r,y,i]),(0,l.jsxs)(s.M,{h:"100vh",mx:{base:-4,lg:-6},children:[w&&(0,l.jsx)(f.Z,{}),r&&h&&(0,l.jsx)(n.xu,{allow:"clipboard-read; clipboard-write;",ref:i,sandbox:"allow-forms allow-orientation-lock allow-pointer-lock allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation allow-popups",as:"iframe",h:"100%",w:"100%",display:w?"none":"block",src:r.url,title:r.title,onLoad:Z},b)]})};var pages_MarketplaceApp=()=>{let{address:a,sendTransaction:e,signMessage:r,signTypedData:t}=function(){let{address:a}=(0,m.mA)(),{chain:e}=(0,m.LN)(),{sendTransactionAsync:r}=(0,m.pQ)(),{signMessageAsync:l}=(0,m.QW)(),{signTypedDataAsync:t}=(0,m.yw)(),{switchNetworkAsync:s}=(0,m.g0)({chainId:Number(d.Z.chain.id)}),n=(0,u.useCallback)(async()=>{Number(d.Z.chain.id)!==(null==e?void 0:e.id)&&await (null==s?void 0:s())},[e,s]),o=(0,u.useCallback)(async a=>{await n();let e=await r(a);return e.hash},[r,n]),c=(0,u.useCallback)(async a=>{await n();let e=await l({message:a});return e},[l,n]),i=(0,u.useCallback)(async a=>{await n(),a.domain&&(a.domain.chainId=Number(a.domain.chainId));let e=await t(a);return e},[t,n]);return{address:a,sendTransaction:o,signMessage:c,signTypedData:i}}(),s=(0,b.Z)(),n=(0,i.useRouter)(),p=(0,w.Z)(n.query.id),f=(0,o.a)({queryKey:["marketplace-apps",p],queryFn:async()=>{let a=await s(Z,void 0,{resource:"marketplace-apps"});if(!Array.isArray(a))throw a;let e=a.find(a=>a.id===p);if(!e)throw{status:404};return e},enabled:y.isEnabled}),{data:g,isPending:v}=f;return(0,u.useEffect)(()=>{g&&k.V({pathname:"/apps/[id]",query:{id:g.id}},{app_name:g.title})},[g]),(0,h.Z)(f),(0,l.jsx)(c.y,{address:a,appUrl:null==g?void 0:g.url,rpcUrl:d.Z.chain.rpcUrl,sendTransaction:e,signMessage:r,signTypedData:t,children:(0,l.jsx)(MarketplaceAppContent,{address:a,data:g,isPending:v})})}},46601:function(){}}]);
//# sourceMappingURL=2650.f2a28e85f572cd15.js.map