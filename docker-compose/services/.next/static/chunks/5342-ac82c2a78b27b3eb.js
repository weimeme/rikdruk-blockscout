"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5342],{53599:function(e,t,l){l.d(t,{Z:function(){return downloadBlob}});function downloadBlob(e,t){let l=URL.createObjectURL(e),r=document.createElement("a");r.setAttribute("href",l),r.setAttribute("download",t),r.click(),r.remove(),URL.revokeObjectURL(l)}},15342:function(e,t,l){l.d(t,{Z:function(){return V}});var r=l(85893),s=l(12498),n=l(204),a=l(88911),c=l(33838),o=l(93344),i=l(7754),u=l(23100),d=l(47523),m=l(89154),h=l(36953),x=l(66303),f=l(6450),j=l(46887),b=l(23428),g=l(75350),k=l(29306),y=l.n(k),p=l(67294),C=l(4914),v=l(14853),w=l(57460),S=l(53599),Z=l(96026),_=l(34629),X=l(43818),z=l(55036),Y=l(87098),R=p.memo(e=>{let{type:t,scale:l,ticks:n,tickFormatGenerator:a,disableAnimation:c,anchorEl:o,...i}=e,u=p.useRef(null),d=(0,s.ff)("blackAlpha.600","whiteAlpha.500"),m=(0,_.dQ)("colors",d);return p.useEffect(()=>{if(!u.current)return;let e="left"===t?X.y4O:X.LLu,r=e(l).ticks(n);a&&r.tickFormat(a(r));let s=X.Ys(u.current);c?s.call(r):s.transition().duration(750).ease(X.Nyw).call(r),s.select(".domain").remove(),s.selectAll("line").remove(),s.selectAll("text").attr("opacity",1).attr("color",m).attr("font-size","0.75rem")},[l,n,a,c,t,m]),p.useEffect(()=>{if(!o)return;let e=X.Ys(o);return e.on("mouseout.axisX",()=>{X.Ys(u.current).selectAll("text").style("font-weight","normal")}).on("mousemove.axisX",e=>{let[t]=X.cx$(e,o),r=l.invert(t),s=X.Ys(u.current).selectAll("text"),n=s.data(),a=X.YFb(e=>e).left(n,r);s.style("font-weight",(e,t)=>t===a-1?"bold":"normal")}),()=>{e.on("mouseout.axisX mousemove.axisX",null)}},[o,l]),(0,r.jsx)("g",{ref:u,...i})}),A=p.memo(e=>{let{type:t,scale:l,ticks:s,size:n,disableAnimation:a,...c}=e,o=p.useRef(null),i=(0,_.dQ)("colors","divider");return p.useEffect(()=>{if(!o.current)return;let e="vertical"===t?X.LLu:X.y4O,r=e(l).ticks(s).tickSize(-n),c=X.Ys(o.current);a?c.call(r):c.transition().duration(750).ease(X.Nyw).call(r),c.select(".domain").remove(),c.selectAll("text").remove(),c.selectAll("line").attr("stroke",i)},[l,s,n,a,t,i]),(0,r.jsx)("g",{ref:o,...c})}),E=l(5422),M=l(41338),N=p.memo(e=>{let{anchorEl:t,height:l,scale:s,data:n,onSelect:a}=e,c=(0,_.dQ)("colors","blue.200"),o=p.useRef(null),i=p.useRef(!1),u=p.useRef(),d=p.useRef(),m=p.useCallback(e=>{let t=s.invert(e),l=X.YFb(e=>e.date).left;return l(n[0].items,t,1)},[n,s]),h=p.useCallback((e,t)=>{let l=t-e;X.Ys(o.current).attr("opacity",1),X.Ys(o.current).select(".ChartSelectionX__line_left").attr("x1",e).attr("x2",e),X.Ys(o.current).select(".ChartSelectionX__line_right").attr("x1",t).attr("x2",t),X.Ys(o.current).select(".ChartSelectionX__rect").attr("x",l>0?e:l+e).attr("width",Math.abs(l))},[]),x=p.useCallback((e,t)=>{let l=s.invert(e),r=s.invert(t);Math.abs((0,C.Z)(l).diff(r,"day"))>2&&a([C.Z.min((0,C.Z)(l),(0,C.Z)(r)).toDate(),C.Z.max((0,C.Z)(l),(0,C.Z)(r)).toDate()])},[a,s]),f=p.useCallback(()=>{i.current=!1,u.current=void 0,d.current=void 0,X.Ys(o.current).attr("opacity",0)},[]),j=p.useCallback(()=>{i.current&&(u.current&&d.current&&x(u.current,d.current),f())},[f,x]);return p.useEffect(()=>{if(!t)return;let e=X.Ys(t);return e.on("mousedown.selectionX",e=>{let[l]=X.cx$(e,t);i.current=!0,u.current=l}).on("mousemove.selectionX",e=>{if(i.current){let[l]=X.cx$(e,t);u.current&&h(u.current,l),d.current=l}}).on("mouseup.selectionX",j).on("touchstart.selectionX",e=>{let l=X.daD(e,t);i.current=2===l.length}).on("touchmove.selectionX",e=>{if(i.current){let l=X.daD(e,t);2===l.length&&Math.abs(l[0][0]-l[1][0])>5&&(h(l[0][0],l[1][0]),u.current=l[0][0],d.current=l[1][0])}}).on("touchend.selectionX",j),X.Ys("body").on("mouseup.selectionX",function(t){let l=void 0!==u.current&&t.target!==e.node();l&&j()}),()=>{e.on(".selectionX",null),X.Ys("body").on(".selectionX",null)}},[t,f,h,m,j,x]),(0,r.jsxs)("g",{className:"ChartSelectionX",ref:o,opacity:0,children:[(0,r.jsx)("rect",{className:"ChartSelectionX__rect",width:0,height:l,fill:"rgba(66, 153, 225, 0.1)"}),(0,r.jsx)("line",{className:"ChartSelectionX__line ChartSelectionX__line_left",x1:0,x2:0,y1:0,y2:l,stroke:c}),(0,r.jsx)("line",{className:"ChartSelectionX__line ChartSelectionX__line_right",x1:0,x2:0,y1:0,y2:l,stroke:c})]})}),L=l(99483),O=l(84340);let G={bottom:20,left:40,right:20,top:10};var F=p.memo(e=>{let{isEnlarged:t,items:l,onZoom:s,isZoomResetInitial:n,title:a,margin:c,units:o}=e,i=(0,z.Z)(),u=(0,_.dQ)("colors","#e0a532"),d="chart-".concat(a.split(" ").join(""),"-").concat(t?"fullscreen":"small"),m=p.useRef(null),[h,x]=p.useState([l[0].date,l[l.length-1].date]),f=p.useMemo(()=>l.filter(e=>e.date>=h[0]&&e.date<=h[1]),[l,h]),j=f.length>1e11,b=p.useMemo(()=>j?X.Q3u(f,e=>({date:e[0].date,value:X.Smz(e,e=>e.value),dateLabel:"".concat(X.i$Z("%e %b %Y")(e[0].date)," â€“ ").concat(X.i$Z("%e %b %Y")(e[e.length-1].date))}),e=>"".concat((0,C.Z)(e.date).week()," / ").concat((0,C.Z)(e.date).year())).map(e=>{let[,t]=e;return t}):f,[j,f]),g=p.useMemo(()=>[{items:b,name:"Value",color:u,units:o}],[u,b,o]),k=p.useMemo(()=>({...G,...c}),[c]),y=p.useMemo(()=>({x:{ticks:t?8:4},y:{ticks:t?6:3,nice:!0}}),[t]),{ref:v,rect:w,innerWidth:S,innerHeight:Z,chartMargin:F,axis:I}=(0,O.Z)({data:g,margin:k,axesConfig:y}),D=p.useCallback(e=>{x([e[0],e[1]]),s()},[s]);return p.useEffect(()=>{n&&x([l[0].date,l[l.length-1].date])},[n,l]),(0,r.jsx)("svg",{width:"100%",height:"100%",ref:v,cursor:"pointer",id:d,opacity:w?1:0,children:(0,r.jsxs)("g",{transform:"translate(".concat((null==F?void 0:F.left)||0,",").concat((null==F?void 0:F.top)||0,")"),children:[(0,r.jsx)(A,{type:"horizontal",scale:I.y.scale,ticks:y.y.ticks,size:S,disableAnimation:!0}),(0,r.jsx)(Y.Z,{id:d,data:b,color:u,xScale:I.x.scale,yScale:I.y.scale}),(0,r.jsx)(E.Z,{data:b,xScale:I.x.scale,yScale:I.y.scale,stroke:u,animation:"none",strokeWidth:i?1:2}),(0,r.jsx)(R,{type:"left",scale:I.y.scale,ticks:y.y.ticks,tickFormatGenerator:I.y.tickFormatter,disableAnimation:!0}),(0,r.jsx)(R,{type:"bottom",scale:I.x.scale,transform:"translate(0, ".concat(Z,")"),ticks:y.x.ticks,anchorEl:m.current,tickFormatGenerator:I.x.tickFormatter,disableAnimation:!0}),(0,r.jsxs)(M.Z,{ref:m,width:S,height:Z,children:[(0,r.jsx)(L.Z,{anchorEl:m.current,width:S,tooltipWidth:j?280:200,height:Z,xScale:I.x.scale,yScale:I.y.scale,data:g}),(0,r.jsx)(N,{anchorEl:m.current,height:Z,scale:I.x.scale,data:g,onSelect:D})]})]})})}),I=l(34151),D=l(65291),B=l(77374),Q=l(31708),T=l(14418),U=l(96272),W=l(23438),$=l(56880),chart_FullscreenChartModal=e=>{let{isOpen:t,title:l,description:s,items:n,units:c,onClose:o}=e,[i,d]=p.useState(!0),m=(0,p.useCallback)(()=>{d(!1)},[]),h=(0,p.useCallback)(()=>{d(!0)},[]);return(0,r.jsxs)(I.u_,{isOpen:t,onClose:o,size:"full",isCentered:!0,children:[(0,r.jsx)(D.Z,{}),(0,r.jsxs)(B.h,{children:[(0,r.jsx)(u.xu,{mb:1,children:(0,r.jsxs)(Q.r,{gridColumnGap:2,children:[(0,r.jsx)(T.X,{mb:1,size:{base:"xs",sm:"md"},children:l}),s&&(0,r.jsx)(a.x,{gridColumn:1,as:"p",variant:"secondary",fontSize:"xs",children:s}),!i&&(0,r.jsx)(U.z,{leftIcon:(0,r.jsx)(Z.Z,{name:"repeat_arrow",w:4,h:4}),colorScheme:"blue",gridColumn:2,justifySelf:"end",alignSelf:"top",gridRow:"1/3",size:"sm",variant:"outline",onClick:h,children:"Reset zoom"})]})}),(0,r.jsx)(W.o,{}),(0,r.jsx)($.f,{h:"100%",children:(0,r.jsx)(F,{margin:{bottom:60},isEnlarged:!0,items:n,units:c,onZoom:m,isZoomResetInitial:i,title:l})})]})]})},V=p.memo((0,g.m)(e=>{let{items:t,title:l,description:g,isLoading:k,className:_,isError:X,units:z}=e,Y=(0,p.useRef)(null),[R,A]=(0,p.useState)(!1),[E,M]=p.useState(!0),N=(0,s.ff)("white","black"),L=(0,s.ff)("gray.200","gray.600"),O=(0,p.useCallback)(()=>{M(!1)},[]),G=(0,p.useCallback)(()=>{M(!0)},[]),I=(0,p.useCallback)(()=>{A(!0)},[]),D=(0,p.useCallback)(()=>{A(!1)},[]),B=(0,p.useCallback)(()=>{setTimeout(()=>{Y.current&&y().toPng(Y.current,{quality:100,bgcolor:N,width:5*Y.current.offsetWidth,height:5*Y.current.offsetHeight,filter:e=>"BUTTON"!==e.nodeName,style:{borderColor:"transparent",transform:"scale(".concat(5,")"),"transform-origin":"top left"}}).then(e=>{let t=document.createElement("a");t.download="".concat(l," (Blockscout chart).png"),t.href=e,t.click(),t.remove()})},100)},[N,l]),Q=(0,p.useCallback)(()=>{if(t){let e=t.map(e=>[(0,C.Z)(e.date).format("YYYY-MM-DD"),String(e.value)]);!function(e,t,l){let r=(0,w.unparse)([e,...t]),s=new Blob([r],{type:"text/csv;charset=utf-8;"});(0,S.Z)(s,l)}(["Date","Value"],e,"".concat(l," (Blockscout stats)"))}},[t,l]),T=t&&t.length>2,U=X?(0,r.jsx)(n.k,{alignItems:"center",justifyContent:"center",flexGrow:1,py:4,children:(0,r.jsxs)(a.x,{variant:"secondary",fontSize:"sm",textAlign:"center",children:["The data didn".concat(v.Iy,"t load. Please, "),(0,r.jsx)(c.r,{href:window.document.location.href,children:"try to reload the page."})]})}):k?(0,r.jsx)(o.O,{flexGrow:1,w:"100%"}):T?(0,r.jsx)(u.xu,{flexGrow:1,maxW:"100%",children:(0,r.jsx)(F,{items:t,onZoom:O,isZoomResetInitial:E,title:l,units:z})}):(0,r.jsx)(i.M,{flexGrow:1,children:(0,r.jsx)(a.x,{variant:"secondary",fontSize:"sm",children:"No data"})});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.k,{height:"100%",ref:Y,flexDir:"column",padding:{base:3,lg:4},borderRadius:"md",border:"1px",borderColor:L,className:_,children:[(0,r.jsxs)(n.k,{columnGap:6,mb:1,alignItems:"flex-start",children:[(0,r.jsxs)(n.k,{flexGrow:1,flexDir:"column",alignItems:"flex-start",children:[(0,r.jsx)(o.O,{isLoaded:!k,fontWeight:600,size:{base:"xs",lg:"sm"},children:l}),g&&(0,r.jsx)(o.O,{isLoaded:!k,color:"text_secondary",fontSize:"xs",mt:1,children:(0,r.jsx)("span",{children:g})})]}),(0,r.jsxs)(n.k,{ml:"auto",columnGap:2,children:[(0,r.jsx)(d.u,{label:"Reset zoom",children:(0,r.jsx)(m.h,{hidden:E,"aria-label":"Reset zoom",colorScheme:"blue",w:9,h:8,size:"sm",variant:"outline",onClick:G,icon:(0,r.jsx)(Z.Z,{name:"repeat_arrow",w:4,h:4})})}),T&&(0,r.jsxs)(h.v,{children:[(0,r.jsx)(o.O,{isLoaded:!k,borderRadius:"base",children:(0,r.jsx)(x.j,{w:"36px",h:"32px",icon:(0,r.jsx)(Z.Z,{name:"vertical_dots",w:4,h:4}),colorScheme:"gray",variant:"ghost",as:m.h,children:(0,r.jsx)(f.TX,{children:"Open chart options menu"})})}),(0,r.jsxs)(j.q,{children:[(0,r.jsxs)(b.s,{display:"flex",alignItems:"center",onClick:I,children:[(0,r.jsx)(Z.Z,{name:"scope",boxSize:5,mr:3}),"View fullscreen"]}),(0,r.jsxs)(b.s,{display:"flex",alignItems:"center",onClick:B,children:[(0,r.jsx)(Z.Z,{name:"files/image",boxSize:5,mr:3}),"Save as PNG"]}),(0,r.jsxs)(b.s,{display:"flex",alignItems:"center",onClick:Q,children:[(0,r.jsx)(Z.Z,{name:"files/csv",boxSize:5,mr:3}),"Save as CSV"]})]})]})]})]}),U]}),T&&(0,r.jsx)(chart_FullscreenChartModal,{isOpen:R,items:t,title:l,description:g,onClose:D,units:z})]})}))}}]);
//# sourceMappingURL=5342-ac82c2a78b27b3eb.js.map