"use strict";var g=Object.defineProperty;var p=(r,n)=>g(r,"name",{value:n,configurable:!0});var d=require("./codemirror.cjs.js"),a=require("graphql"),b=require("./forEachState.cjs.js");require("./index.cjs.js");require("react");require("react-dom");function u(r,n,t){const i=j(t,m(n.string));if(!i)return;const e=n.type!==null&&/"|\w/.test(n.string[0])?n.start:n.end;return{list:i,from:{line:r.line,ch:e},to:{line:r.line,ch:n.end}}}p(u,"hintList");function j(r,n){if(!n)return y(r,o=>!o.isDeprecated);const t=r.map(o=>({proximity:x(m(o.text),n),entry:o}));return y(y(t,o=>o.proximity<=2),o=>!o.entry.isDeprecated).sort((o,l)=>(o.entry.isDeprecated?1:0)-(l.entry.isDeprecated?1:0)||o.proximity-l.proximity||o.entry.text.length-l.entry.text.length).map(o=>o.entry)}p(j,"filterAndSortList");function y(r,n){const t=r.filter(n);return t.length===0?r:t}p(y,"filterNonEmpty");function m(r){return r.toLowerCase().replace(/\W/g,"")}p(m,"normalizeText");function x(r,n){let t=T(n,r);return r.length>n.length&&(t-=r.length-n.length-1,t+=r.indexOf(n)===0?0:.5),t}p(x,"getProximity");function T(r,n){let t,i;const e=[],o=r.length,l=n.length;for(t=0;t<=o;t++)e[t]=[t];for(i=1;i<=l;i++)e[0][i]=i;for(t=1;t<=o;t++)for(i=1;i<=l;i++){const f=r[t-1]===n[i-1]?0:1;e[t][i]=Math.min(e[t-1][i]+1,e[t][i-1]+1,e[t-1][i-1]+f),t>1&&i>1&&r[t-1]===n[i-2]&&r[t-2]===n[i-1]&&(e[t][i]=Math.min(e[t][i],e[t-2][i-2]+f))}return e[o][l]}p(T,"lexicalDistance");d.CodeMirror.registerHelper("hint","graphql-variables",(r,n)=>{const t=r.getCursor(),i=r.getTokenAt(t),e=L(t,i,n);return(e==null?void 0:e.list)&&e.list.length>0&&(e.from=d.CodeMirror.Pos(e.from.line,e.from.ch),e.to=d.CodeMirror.Pos(e.to.line,e.to.ch),d.CodeMirror.signal(r,"hasCompletion",r,e,i)),e});function L(r,n,t){const i=n.state.kind==="Invalid"?n.state.prevState:n.state,e=i.kind,o=i.step;if(e==="Document"&&o===0)return u(r,n,[{text:"{"}]);const l=t.variableToType;if(!l)return;const f=v(l,n.state);if(e==="Document"||e==="Variable"&&o===0){const c=Object.keys(l);return u(r,n,c.map(s=>({text:`"${s}": `,type:l[s]})))}if((e==="ObjectValue"||e==="ObjectField"&&o===0)&&f.fields){const c=Object.keys(f.fields).map(s=>f.fields[s]);return u(r,n,c.map(s=>({text:`"${s.name}": `,type:s.type,description:s.description})))}if(e==="StringValue"||e==="NumberValue"||e==="BooleanValue"||e==="NullValue"||e==="ListValue"&&o===1||e==="ObjectField"&&o===2||e==="Variable"&&o===2){const c=f.type?a.getNamedType(f.type):void 0;if(c instanceof a.GraphQLInputObjectType)return u(r,n,[{text:"{"}]);if(c instanceof a.GraphQLEnumType){const s=c.getValues();return u(r,n,s.map(h=>({text:`"${h.name}"`,type:c,description:h.description})))}else if(c===a.GraphQLBoolean)return u(r,n,[{text:"true",type:a.GraphQLBoolean,description:"Not false."},{text:"false",type:a.GraphQLBoolean,description:"Not true."}])}}p(L,"getVariablesHint");function v(r,n){const t={type:null,fields:null};return b.forEachState(n,i=>{if(i.kind==="Variable")t.type=r[i.name];else if(i.kind==="ListValue"){const e=t.type?a.getNullableType(t.type):void 0;t.type=e instanceof a.GraphQLList?e.ofType:null}else if(i.kind==="ObjectValue"){const e=t.type?a.getNamedType(t.type):void 0;t.fields=e instanceof a.GraphQLInputObjectType?e.getFields():null}else if(i.kind==="ObjectField"){const e=i.name&&t.fields?t.fields[i.name]:null;t.type=e==null?void 0:e.type}}),t}p(v,"getTypeInfo");
